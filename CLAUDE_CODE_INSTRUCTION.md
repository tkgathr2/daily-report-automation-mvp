# Claude Codeへの実装指示

## 実装タスク

Googleカレンダーと営業KPIシートから日報を自動生成し、Slackに送信するシステムを実装してください。

## 参照ドキュメント

- **仕様書：** `docs/plan.md`
- **実装手順：** `docs/checkpoints.md`

## 実装手順（必須）

`docs/checkpoints.md` の CP-01 → CP-08 の順で実装してください。

1. **CP-01：スプレッドシートの初期設定**は手動で行う必要があるため、GASスクリプトの実装から開始
2. **CP-02：GASスクリプトの基本構造作成**から実装を開始
3. 各チェックポイントでテストを実施
4. 失敗した場合は、直前のチェックポイントに戻って同じCPを再実行
5. エラーが発生した場合は `logs/debug_latest.txt` に原因が分かる形で記録

## 実装時の注意事項

### 必須事項

- `docs/plan.md` を唯一の仕様として参照（他のファイルや推測に頼らない）
- 仕様書の「13. 実装方針」の関数構成と定数定義に従う
- 仕様書の「9.6 エラーメッセージ一覧」のエラーメッセージを使用
- すべてのエラーケースでエラーハンドリングを実装
- コードに日本語コメントを追加

### 実装範囲

- Google Apps Script（GAS）のコードのみ実装
- スプレッドシートの作成・設定は手動（CP-01は実装範囲外）
- テストは各チェックポイントで実施

### エラーハンドリング

- 仕様書の「9. 例外ケースとエラーハンドリング」のすべてのケースを実装
- エラーメッセージは仕様書の「9.6 エラーメッセージ一覧」に従う
- すべてのエラーは処理を中断し、`Browser.msgBox()`でユーザーに表示
- 開発者向けの詳細情報は`Logger.log()`で記録

### コード品質

- 仕様書の「22. 実装上の注意事項・ベストプラクティス」に従う
- 変数名・関数名はcamelCase、定数名はUPPER_SNAKE_CASE
- 関数は単一責任の原則に従い、適切に分割
- コードレビューチェックリスト（仕様書「23. コードレビューチェックリスト」）を確認

### 不明点・迷った場合

- 迷ったら必ずユーザーに確認して停止
- 仕様書に記載がない内容は推測せず、確認を取る

## 実装後の確認事項

1. **コードの動作確認**
   - 正常系テストを実施（仕様書「14.1 正常系テスト」）
   - 異常系テストを実施（仕様書「14.2 異常系テスト」）

2. **バグチェック**
   - 仕様書の「12. NG例（動作上のNG）」が発生しないことを確認
   - 受け入れ条件（仕様書「11. 受け入れ条件」）をすべて満たしていることを確認
   - コードレビューチェックリスト（仕様書「23. コードレビューチェックリスト」）を確認

3. **GitHubへのコミット・プッシュ**
   - 実装が完了し、動作確認が取れたらGitHubにcommit & push
   - commitメッセージは作業内容が一目で分かる日本語タイトルを付ける
   - 「WIP」「update」「fix」など内容が分からないタイトルは禁止
   - タイトルは自分で考える（例：「日報自動生成システムのGASスクリプト実装完了」）

## 実装ファイル

- GASスクリプトは `src/Code.gs` として作成してください

## その他

- 実装中に問題が発生した場合は、`logs/debug_latest.txt`に原因を記録
- 実装完了後、動作確認とバグチェックを自分で実施してから進める
- すべてのテストがパスすることを確認してからGitHubにcommit & push
