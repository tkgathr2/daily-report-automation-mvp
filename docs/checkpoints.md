# チェックポイント（実装手順）

## CP-01: スプレッドシートの初期設定

- [ ] 新しいGoogleスプレッドシートを作成
- [ ] シート①「KPI」を作成し、列ヘッダーを設定（日付、訪問数、架電数、商談数）
- [ ] シート②「DailyReport_Draft」を作成し、列ヘッダーを設定
- [ ] シート③「Config」を作成し、設定項目と設定値を記入
- [ ] テスト用のKPIデータを1行以上入力

## CP-02: GASスクリプトの基本構造作成

- [ ] スプレッドシートにGASスクリプトエディタを開く
- [ ] メイン関数 `generateDailyReport()` を作成
- [ ] 設定読み込み関数 `getConfigValue(key)` を作成
- [ ] カスタムメニューを追加する関数 `onOpen()` を作成
- [ ] スクリプトを保存・実行権限を付与

## CP-03: カレンダー連携実装

- [ ] `getCalendarEvents(date)` 関数を作成
- [ ] Calendar APIを使用して当日の予定を取得
- [ ] `formatScheduleText(events)` 関数でテキストフォーマット
- [ ] テスト：カレンダー予定が正しく取得できることを確認

## CP-04: KPIシート連携実装

- [ ] `getKPIData(date)` 関数を作成
- [ ] KPIシートから該当日の行を検索
- [ ] データが存在しない場合のエラーハンドリング
- [ ] `formatKPIText(kpiData)` 関数でテキストフォーマット
- [ ] テスト：KPIデータが正しく取得できることを確認

## CP-05: 日報下書き生成実装

- [ ] `generateDailyReport()` のメインロジックを実装
- [ ] DailyReport_Draftシートにデータを書き込み
- [ ] 同日の行が存在する場合は上書き処理
- [ ] テスト：日報下書きが正しく生成されることを確認

## CP-06: Slack送信機能実装

- [ ] `formatDailyReportText(rowData)` 関数を作成
- [ ] `sendToSlack(date)` 関数を作成
- [ ] Webhook URLを使用してSlackに投稿
- [ ] 送信成功時に送信済みフラグと送信日時を更新
- [ ] 送信済みフラグチェックを実装
- [ ] テスト：Slack送信が正常に動作することを確認

## CP-07: エラーハンドリング実装

- [ ] カレンダー関連エラーの処理
- [ ] KPIシート関連エラーの処理
- [ ] Slack送信関連エラーの処理
- [ ] Config設定関連エラーの処理
- [ ] すべてのエラーケースをテスト

## CP-08: 統合テスト

- [ ] 正常系テスト（すべてのテスト項目を実行）
- [ ] 異常系テスト（すべてのテスト項目を実行）
- [ ] 受け入れ条件10項目をチェック
- [ ] NG例が発生しないことを確認
