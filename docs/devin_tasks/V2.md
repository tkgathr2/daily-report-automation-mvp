# Devin タスク: V2 実装

## これは Devin への指示です。

---

## タスク概要

簡単日報くん V2（テンプレート変更＋入力欄追加＋翌日引き継ぎ）を実装する。

## 参照ドキュメント

- 要件定義書: `docs/specs/V2_requirements_ASK.md`
- 仕様書: `docs/specs/V2_plan.md`

## 実装対象ファイル

- `src/Code.gs`
- `src/Index.html`

---

## 実装手順

### Step 1: Code.gs に定数追加

`src/Code.gs` の定数定義セクションに以下を追加:

```javascript
// V2追加定数
const USER_PROPERTY_NEXT_TASKS = 'NEXT_TASKS_DATA';
const DATE_FORMAT_V2 = 'yyyy年MM月dd日';
```

### Step 2: Code.gs に関数追加

以下の関数を `src/Code.gs` に追加:

1. `getUserName()` - ユーザー名取得
2. `getTodayDateFormattedV2()` - V2日付フォーマット
3. `saveNextTasks(tasks)` - 「次すること」保存
4. `getNextTasks()` - 「次すること」取得
5. `getInitialDataV2()` - 初期データ一括取得
6. `sendToSlackV2(reportData)` - V2用Slack送信
7. `formatSlackMessageV2(reportData)` - V2用メッセージフォーマット

※ 各関数の実装詳細は `docs/specs/V2_plan.md` を参照

### Step 3: Index.html のHTML変更

テキストエリアを4セクション構成に変更:

1. 日報ヘッダー（日付＋氏名）
2. 「今日やったこと」
3. 「わかった事・問題・共有事項」
4. 「売上・利益に関わるポイント」
5. 「次すること」

### Step 4: Index.html のCSS追加

- `.report-header` - 日報ヘッダースタイル
- `#todayTasks, #notices, #salesPoints, #nextTasks` - テキストエリアの高さ
- `.validation-error` - エラー時のハイライト

### Step 5: Index.html のJavaScript変更

1. `initV2()` - V2初期化
2. `validateSectionsV2()` - バリデーション
3. `sendSlackV2()` - V2 Slack送信
4. `copyToClipboardV2()` - V2コピー
5. `onLoadEventsSuccessV2()` - カレンダー取得成功時

---

## 完了条件

1. 新テンプレート（4セクション）で表示される
2. 日付が「YYYY年MM月DD日」形式で表示される
3. 氏名がGoogleアカウントから取得・表示される
4. 全セクション必須バリデーションが動作する
5. 「次すること」が翌日に引き継がれる
6. 既存機能が正常動作する

---

## テスト項目

仕様書のテスト項目（正常系9項目、異常系6項目）を実行し、全てパスすること。
